<!DOCTYPE html>
<html>
<head>
    <title>Table Examples</title>
    <meta charset="UTF-8">
    <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apache-arrow@14.0.1/Arrow.es2015.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        #controls {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        #$div_id {
            width: 100%;
            height: 600px;
        }
    </style>
        <style>
        .textblock-content {
            padding: 20px;
            margin: 10px 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
        }

        .textblock-content h1 {
            font-size: 2em;
            margin-top: 0.5em;
            margin-bottom: 0.5em;
            font-weight: 600;
        }

        .textblock-content h2 {
            font-size: 1.5em;
            margin-top: 0.5em;
            margin-bottom: 0.5em;
            font-weight: 600;
        }

        .textblock-content h3 {
            font-size: 1.25em;
            margin-top: 0.5em;
            margin-bottom: 0.5em;
            font-weight: 600;
        }

        .textblock-content p {
            margin: 0.5em 0;
        }

        .textblock-content ul, .textblock-content ol {
            margin: 0.5em 0;
            padding-left: 2em;
        }

        .textblock-content code {
            background-color: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .textblock-content pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }

        .textblock-content pre code {
            background-color: transparent;
            padding: 0;
        }

        .textblock-content blockquote {
            border-left: 4px solid #ddd;
            padding-left: 1em;
            margin-left: 0;
            color: #666;
        }

        .textblock-content a {
            color: #0066cc;
            text-decoration: none;
        }

        .textblock-content a:hover {
            text-decoration: underline;
        }

        .textblock-content table {
            border-collapse: collapse;
            width: 100%;
            margin: 1em 0;
        }

        .textblock-content th, .textblock-content td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        .textblock-content th {
            background-color: #f5f5f5;
            font-weight: 600;
        }
    </style>
    <style>
        .picture-container {
            padding: 20px;
            margin: 10px 0;
            text-align: center;
        }

        .picture-container h2 {
            font-size: 1.5em;
            margin-bottom: 0.5em;
            font-weight: 600;
        }

        .picture-container img {
            max-width: 100%;
            height: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .picture-container svg {
            max-width: 100%;
            height: auto;
        }
    </style>
    <style>
        .jsplots-table-container {
            padding: 20px;
            margin: 10px 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }

        .jsplots-table-container h2 {
            font-size: 1.5em;
            margin-bottom: 0.5em;
            font-weight: 600;
            color: #333;
        }

        .jsplots-table-container p {
            color: #666;
            margin-bottom: 1em;
        }

        .table-wrapper {
            overflow-x: auto;
            margin-bottom: 1em;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .jsplots-table-container table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
        }

        .jsplots-table-container th {
            background-color: #f8f9fa;
            color: #333;
            font-weight: 600;
            text-align: left;
            padding: 12px 15px;
            border-bottom: 2px solid #dee2e6;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .jsplots-table-container td {
            padding: 10px 15px;
            border-bottom: 1px solid #dee2e6;
            color: #495057;
        }

        .jsplots-table-container tr:hover {
            background-color: #f8f9fa;
        }

        .jsplots-table-container tr:last-child td {
            border-bottom: none;
        }

        .table-actions {
            text-align: center;
            padding: 10px 0;
        }

        .download-csv-button {
            background-color: #0066cc;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 500;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .download-csv-button:hover {
            background-color: #0052a3;
        }

        .download-csv-button:active {
            background-color: #003d7a;
            transform: translateY(1px);
        }
    </style>


    <!-- external libs -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.11/c3.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.11/c3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/pivot.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/pivot.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/d3_renderers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/c3_renderers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/export_renderers.min.js"></script>
</head>

<body>

<script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>

<script type="module">
// Import parquet-wasm for Parquet file support
import * as parquet from 'https://unpkg.com/parquet-wasm@0.6.1/esm/parquet_wasm.js';

// Initialize parquet-wasm
await parquet.default();

// Make parquet available globally for loadDataset
window.parquetWasm = parquet;
window.parquetReady = true;
console.log('Parquet-wasm library loaded successfully');
</script>

<script>
// Helper function to wait for parquet-wasm to be loaded
function waitForParquet() {
    return new Promise(function(resolve) {
        if (window.parquetReady) {
            resolve();
            return;
        }
        var checkInterval = setInterval(function() {
            if (window.parquetReady) {
                clearInterval(checkInterval);
                resolve();
            }
        }, 50);
    });
}

// Centralized data loading function
// This function parses data from embedded or external sources and returns a Promise
// Supports CSV (embedded/external), JSON (embedded/external), and Parquet (external) formats
// Usage: loadDataset('dataLabel').then(function(data) { /* use data */ });
function loadDataset(dataLabel) {
    return new Promise(function(resolve, reject) {
        var dataElement = document.getElementById(dataLabel);
        if (!dataElement) {
            reject(new Error('Data element not found: ' + dataLabel));
            return;
        }

        var format = dataElement.getAttribute('data-format') || 'csv_embedded';
        var dataSrc = dataElement.getAttribute('data-src');

        // Handle external JSON files
        if (format === 'json_external' && dataSrc) {
            fetch(dataSrc)
                .then(function(response) {
                    if (!response.ok) {
                        throw new Error('Failed to load ' + dataSrc + ': ' + response.statusText);
                    }
                    return response.json();
                })
                .then(function(data) {
                    resolve(data);
                })
                .catch(function(error) {
                    console.error('Error loading external JSON:', error);
                    reject(error);
                });
            return;
        }

        // Handle external Parquet files
        if (format === 'parquet' && dataSrc) {
            // Wait for parquet-wasm to be loaded first
            waitForParquet()
                .then(function() {
                    return fetch(dataSrc);
                })
                .then(function(response) {
                    if (!response.ok) {
                        throw new Error('Failed to load ' + dataSrc + ': ' + response.statusText);
                    }
                    return response.arrayBuffer();
                })
                .then(function(arrayBuffer) {
                    // Use parquet-wasm to read the file
                    var uint8Array = new Uint8Array(arrayBuffer);

                    // readParquet returns an Arrow Table
                    var wasmTable = window.parquetWasm.readParquet(uint8Array);

                    // Convert to Arrow IPC stream
                    var ipcStream = wasmTable.intoIPCStream();

                    // Use Apache Arrow JS to read the IPC stream
                    var arrowTable = window.Arrow.tableFromIPC(ipcStream);

                    // Convert Arrow Table to array of JavaScript objects
                    var data = [];
                    for (var i = 0; i < arrowTable.numRows; i++) {
                        var row = {};
                        arrowTable.schema.fields.forEach(function(field) {
                            var column = arrowTable.getChild(field.name);
                            var value = column.get(i);

                            // Convert BigInt to Number (Arrow returns BigInt for Int64)
                            if (typeof value === 'bigint') {
                                value = Number(value);
                            }

                            row[field.name] = value;
                        });
                        data.push(row);
                    }

                    resolve(data);
                })
                .catch(function(error) {
                    console.error('Error loading external Parquet:', error);
                    reject(error);
                });
            return;
        }

        // Handle external CSV files
        if (format === 'csv_external' && dataSrc) {
            fetch(dataSrc)
                .then(function(response) {
                    if (!response.ok) {
                        throw new Error('Failed to load ' + dataSrc + ': ' + response.statusText);
                    }
                    return response.text();
                })
                .then(function(csvText) {
                    Papa.parse(csvText, {
                        header: true,
                        dynamicTyping: true,
                        skipEmptyLines: true,
                        complete: function(results) {
                            // Check for fatal errors only (not warnings)
                            var fatalErrors = results.errors.filter(function(err) {
                                return err.type !== 'Delimiter';
                            });

                            if (fatalErrors.length > 0) {
                                console.error('CSV parsing errors:', fatalErrors);
                                reject(fatalErrors);
                            } else if (results.data && results.data.length > 0) {
                                resolve(results.data);
                            } else {
                                reject(new Error('No data parsed from CSV'));
                            }
                        },
                        error: function(error) {
                            console.error('CSV parsing error:', error);
                            reject(error);
                        }
                    });
                })
                .catch(function(error) {
                    console.error('Error loading external CSV:', error);
                    reject(error);
                });
            return;
        }

        // Handle embedded data
        var dataText = dataElement.textContent.trim();

        if (format === 'json_embedded') {
            // Parse JSON data
            try {
                var data = JSON.parse(dataText);
                resolve(data);
            } catch (error) {
                console.error('JSON parsing error:', error);
                reject(error);
            }
        } else if (format === 'csv_embedded') {
            // Parse CSV data using PapaParse
            Papa.parse(dataText, {
                header: true,
                dynamicTyping: true,
                skipEmptyLines: true,
                complete: function(results) {
                    // Check for fatal errors only (not warnings)
                    // PapaParse includes non-fatal warnings in errors array
                    var fatalErrors = results.errors.filter(function(err) {
                        // Filter out delimiter detection warnings - these aren't fatal
                        // (common for single-column CSVs)
                        return err.type !== 'Delimiter';
                    });

                    if (fatalErrors.length > 0) {
                        console.error('CSV parsing errors:', fatalErrors);
                        reject(fatalErrors);
                    } else if (results.data && results.data.length > 0) {
                        resolve(results.data);
                    } else {
                        reject(new Error('No data parsed from CSV'));
                    }
                },
                error: function(error) {
                    console.error('CSV parsing error:', error);
                    reject(error);
                }
            });
        } else {
            reject(new Error('Unsupported data format: ' + format));
        }
    });
}

$(function(){

    window.downloadTableCSV_basic_table = function() {
        const csvContent = "Product,Price,Stock,Category\nWidget,9.99,100,Tools\nGadget,14.99,50,Electronics\nGizmo,24.99,25,Accessories\nTool,19.99,75,Tools\nDevice,34.99,15,Electronics\n";
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'basic_table.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    };
    window.downloadTableCSV_financial_table = function() {
        const csvContent = "Month,Revenue,Expenses,Units_Sold,Profit,Margin_Percent,Avg_Price\nJanuary,45000,30000,450,15000,33.3,100.0\nFebruary,52000,32000,520,20000,38.5,100.0\nMarch,48000,29000,480,19000,39.6,100.0\nApril,61000,35000,610,26000,42.6,100.0\nMay,58000,33000,580,25000,43.1,100.0\nJune,67000,38000,670,29000,43.3,100.0\n";
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'financial_table.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    };
    window.downloadTableCSV_statistics_table = function() {
        const csvContent = "Statistic,Group_A,Group_B\nCount,50.0,50.0\nMean,74.37,81.56\nMedian,73.88,83.62\nStd Dev,8.29,11.6\nMin,55.59,47.02\nMax,89.67,101.36\nQ1,68.62,75.38\nQ3,81.22,89.75\n";
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'statistics_table.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    };
    window.downloadTableCSV_special_chars_table = function() {
        const csvContent = "Name,Description,Price,Rating,Status\nAlice & Bob,Tools & Hardware,100.5,4.5,Active\nCharlie's Shop,Books <Rare>,,4.8,Active\n,Electronics,250.0,,Pending\nD&D Store,,75.25,3.9,Active\nE-Corp,\"Software \"\"Pro\"\"\",500.0,4.2,\n";
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'special_chars_table.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    };
    window.downloadTableCSV_top_performers = function() {
        const csvContent = "Rank,Employee,Department,Score\n1,Sarah Johnson,Sales,98\n2,Mike Chen,Engineering,96\n3,Emma Williams,Sales,95\n4,David Brown,Marketing,94\n5,Lisa Garcia,Engineering,93\n";
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'top_performers.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    };
    window.downloadTableCSV_department_summary = function() {
        const csvContent = "Department,Employees,Avg_Score,Budget\nSales,12,87.3,500000\nEngineering,25,84.5,1200000\nMarketing,8,79.2,350000\nOperations,15,81.8,600000\n";
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'department_summary.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    };
    window.downloadTableCSV_monthly_sales = function() {
        const csvContent = "Month,Days,Total_Revenue,Avg_Daily_Revenue\nJan,31,206081.0,6647.77\nFeb,29,188799.0,6510.31\nMar,31,199854.0,6446.9\nApr,30,188639.0,6287.97\nMay,31,196983.0,6354.29\nJun,30,195473.0,6515.77\n";
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'monthly_sales.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    };
(function() {
    // Configuration
    const FILTER_COLS = [];
    const X_COLS = ['Date'];
    const Y_COLS = ['Revenue'];
    const COLOR_COLS = ['Category'];
    const LINETYPE_COLS = ['Category'];
    const COLOR_MAPS = {'Category': {'Retail': '#00cc96', 'Online': '#636efa', 'Wholesale': '#EF553B'}};
    const LINETYPE_MAPS = {'Category': {'Retail': 'dash', 'Online': 'solid', 'Wholesale': 'dot'}};
    const DEFAULT_X_COL = 'Date';
    const DEFAULT_Y_COL = 'Revenue';
    const DEFAULT_COLOR_COL = 'Category';
    const DEFAULT_LINETYPE_COL = 'Category';
    const X_LABEL = 'Date';
    const Y_LABEL = 'Revenue ($)';

    let allData = [];

    // Aggregation functions
    function aggregate(values, method) {
        if (values.length === 0) return null;
        if (method === 'none') return values;
        if (method === 'count') return [values.length];
        if (method === 'mean') {
            const sum = values.reduce((a, b) => a + b, 0);
            return [sum / values.length];
        }
        if (method === 'median') {
            const sorted = [...values].sort((a, b) => a - b);
            const mid = Math.floor(sorted.length / 2);
            return sorted.length % 2 === 0 ?
                [(sorted[mid - 1] + sorted[mid]) / 2] :
                [sorted[mid]];
        }
        if (method === 'min') return [Math.min(...values)];
        if (method === 'max') return [Math.max(...values)];
        return values;
    }

    // Make it global so inline onchange can see it
    window.updateChart_revenue_trend = function() {
        // Get current X and Y columns
        const xColSelect = document.getElementById('x_col_select_revenue_trend');
        const X_COL = xColSelect ? xColSelect.value : DEFAULT_X_COL;

        const yColSelect = document.getElementById('y_col_select_revenue_trend');
        const Y_COL = yColSelect ? yColSelect.value : DEFAULT_Y_COL;

        // Get current filter values
        const filters = {};
        FILTER_COLS.forEach(col => {
            const select = document.getElementById(col + '_select');
            if (select) {
                filters[col] = select.value;
            }
        });

        // Get current color and linetype columns
        const colorColSelect = document.getElementById('color_col_select_revenue_trend');
        const COLOR_COL = colorColSelect ? colorColSelect.value : DEFAULT_COLOR_COL;

        const linetypeColSelect = document.getElementById('linetype_col_select_revenue_trend');
        const LINETYPE_COL = linetypeColSelect ? linetypeColSelect.value : DEFAULT_LINETYPE_COL;

        // Get current aggregator
        const aggregatorSelect = document.getElementById('aggregator_select_revenue_trend');
        const AGGREGATOR = aggregatorSelect ? aggregatorSelect.value : 'none';

        // Get current facet selections
        const facet1Select = document.getElementById('facet1_select_revenue_trend');
        const facet2Select = document.getElementById('facet2_select_revenue_trend');
        const facet1 = facet1Select && facet1Select.value !== 'None' ? facet1Select.value : null;
        const facet2 = facet2Select && facet2Select.value !== 'None' ? facet2Select.value : null;

        // Build FACET_COLS array based on selections
        const FACET_COLS = [];
        if (facet1) FACET_COLS.push(facet1);
        if (facet2) FACET_COLS.push(facet2);

        // Get color and linetype maps for current selections
        const COLOR_MAP = COLOR_MAPS[COLOR_COL] || {};
        const LINETYPE_MAP = LINETYPE_MAPS[LINETYPE_COL] || {};

        // Filter data
        const filteredData = allData.filter(row => {
            for (let col in filters) {
                if (String(row[col]) !== String(filters[col])) {
                    return false;
                }
            }
            return true;
        });

        if (FACET_COLS.length === 0) {
            // No faceting - group by color and linetype
            const groupedData = {};
            filteredData.forEach(row => {
                const colorVal = String(row[COLOR_COL]);
                const linetypeVal = String(row[LINETYPE_COL]);
                const groupKey = colorVal + '|||' + linetypeVal;
                if (!groupedData[groupKey]) {
                    groupedData[groupKey] = {
                        data: [],
                        color: colorVal,
                        linetype: linetypeVal
                    };
                }
                groupedData[groupKey].data.push(row);
            });

            const traces = [];
            for (let groupKey in groupedData) {
                const group = groupedData[groupKey];
                group.data.sort((a, b) => a[X_COL] - b[X_COL]);

                let xValues, yValues;
                if (AGGREGATOR === 'none') {
                    xValues = group.data.map(row => row[X_COL]);
                    yValues = group.data.map(row => row[Y_COL]);
                } else {
                    // Group by x value and aggregate
                    const xGroups = {};
                    group.data.forEach(row => {
                        const xVal = row[X_COL];
                        if (!xGroups[xVal]) xGroups[xVal] = [];
                        xGroups[xVal].push(row[Y_COL]);
                    });

                    xValues = [];
                    yValues = [];
                    Object.keys(xGroups).sort((a, b) => a - b).forEach(xVal => {
                        const aggregated = aggregate(xGroups[xVal], AGGREGATOR);
                        if (aggregated && aggregated.length > 0) {
                            xValues.push(parseFloat(xVal));
                            yValues.push(aggregated[0]);
                        }
                    });
                }

                const traceName = COLOR_COL === LINETYPE_COL ?
                    group.color :
                    group.color + ' (' + group.linetype + ')';

                traces.push({
                    x: xValues,
                    y: yValues,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: traceName,
                    line: {
                        color: COLOR_MAP[group.color] || '#000000',
                        width: 1,
                        dash: LINETYPE_MAP[group.linetype] || 'solid'
                    },
                    marker: { size: 1 }
                });
            }

            const layout = {
                xaxis: { title: X_LABEL || X_COL },
                yaxis: { title: Y_LABEL || Y_COL },
                hovermode: 'closest',
                showlegend: true
            };

            Plotly.newPlot('revenue_trend', traces, layout, {responsive: true});

        } else if (FACET_COLS.length === 1) {
            // Facet wrap
            const facetCol = FACET_COLS[0];
            const facetValues = [...new Set(filteredData.map(row => row[facetCol]))].sort();
            const nFacets = facetValues.length;

            // Calculate grid dimensions (prefer wider grids)
            const nCols = Math.ceil(Math.sqrt(nFacets * 1.5));
            const nRows = Math.ceil(nFacets / nCols);

            const traces = [];
            const layout = {
                hovermode: 'closest',
                showlegend: true,
                grid: {rows: nRows, columns: nCols, pattern: 'independent'}
            };

            facetValues.forEach((facetVal, idx) => {
                const facetData = filteredData.filter(row => row[facetCol] === facetVal);

                // Group by color and linetype within this facet
                const groupedData = {};
                facetData.forEach(row => {
                    const colorVal = String(row[COLOR_COL]);
                    const linetypeVal = String(row[LINETYPE_COL]);
                    const groupKey = colorVal + '|||' + linetypeVal;
                    if (!groupedData[groupKey]) {
                        groupedData[groupKey] = {
                            data: [],
                            color: colorVal,
                            linetype: linetypeVal
                        };
                    }
                    groupedData[groupKey].data.push(row);
                });

                const row = Math.floor(idx / nCols) + 1;
                const col = (idx % nCols) + 1;
                const xaxis = idx === 0 ? 'x' : 'x' + (idx + 1);
                const yaxis = idx === 0 ? 'y' : 'y' + (idx + 1);

                for (let groupKey in groupedData) {
                    const group = groupedData[groupKey];
                    group.data.sort((a, b) => a[X_COL] - b[X_COL]);

                    let xValues, yValues;
                    if (AGGREGATOR === 'none') {
                        xValues = group.data.map(row => row[X_COL]);
                        yValues = group.data.map(row => row[Y_COL]);
                    } else {
                        // Group by x value and aggregate
                        const xGroups = {};
                        group.data.forEach(row => {
                            const xVal = row[X_COL];
                            if (!xGroups[xVal]) xGroups[xVal] = [];
                            xGroups[xVal].push(row[Y_COL]);
                        });

                        xValues = [];
                        yValues = [];
                        Object.keys(xGroups).sort((a, b) => a - b).forEach(xVal => {
                            const aggregated = aggregate(xGroups[xVal], AGGREGATOR);
                            if (aggregated && aggregated.length > 0) {
                                xValues.push(parseFloat(xVal));
                                yValues.push(aggregated[0]);
                            }
                        });
                    }

                    const traceName = COLOR_COL === LINETYPE_COL ?
                        group.color :
                        group.color + ' (' + group.linetype + ')';
                    const legendGroup = traceName;

                    traces.push({
                        x: xValues,
                        y: yValues,
                        type: 'scatter',
                        mode: 'lines+markers',
                        name: traceName,
                        legendgroup: legendGroup,
                        showlegend: idx === 0,
                        xaxis: xaxis,
                        yaxis: yaxis,
                        line: {
                            color: COLOR_MAP[group.color] || '#000000',
                            width: 1,
                            dash: LINETYPE_MAP[group.linetype] || 'solid'
                        },
                        marker: { size: 1 }
                    });
                }

                // Add axis configuration
                layout[xaxis] = {
                    title: row === nRows ? (X_LABEL || X_COL) : '',
                    anchor: yaxis
                };
                layout[yaxis] = {
                    title: col === 1 ? (Y_LABEL || Y_COL) : '',
                    anchor: xaxis
                };

                // Add annotation for facet label
                if (!layout.annotations) layout.annotations = [];
                layout.annotations.push({
                    text: facetCol + ': ' + facetVal,
                    showarrow: false,
                    xref: xaxis === 'x' ? 'x domain' : xaxis + ' domain',
                    yref: yaxis === 'y' ? 'y domain' : yaxis + ' domain',
                    x: 0.5,
                    y: 1.05,
                    xanchor: 'center',
                    yanchor: 'bottom',
                    font: {size: 10}
                });
            });

            Plotly.newPlot('revenue_trend', traces, layout, {responsive: true});

        } else {
            // Facet grid (2 facet columns)
            const facetRow = FACET_COLS[0];
            const facetCol = FACET_COLS[1];
            const rowValues = [...new Set(filteredData.map(row => row[facetRow]))].sort();
            const colValues = [...new Set(filteredData.map(row => row[facetCol]))].sort();
            const nRows = rowValues.length;
            const nCols = colValues.length;

            const traces = [];
            const layout = {
                hovermode: 'closest',
                showlegend: true,
                grid: {rows: nRows, columns: nCols, pattern: 'independent'}
            };

            rowValues.forEach((rowVal, rowIdx) => {
                colValues.forEach((colVal, colIdx) => {
                    const facetData = filteredData.filter(row =>
                        row[facetRow] === rowVal && row[facetCol] === colVal
                    );

                    // Group by color and linetype within this facet
                    const groupedData = {};
                    facetData.forEach(row => {
                        const colorVal = String(row[COLOR_COL]);
                        const linetypeVal = String(row[LINETYPE_COL]);
                        const groupKey = colorVal + '|||' + linetypeVal;
                        if (!groupedData[groupKey]) {
                            groupedData[groupKey] = {
                                data: [],
                                color: colorVal,
                                linetype: linetypeVal
                            };
                        }
                        groupedData[groupKey].data.push(row);
                    });

                    const idx = rowIdx * nCols + colIdx;
                    const xaxis = idx === 0 ? 'x' : 'x' + (idx + 1);
                    const yaxis = idx === 0 ? 'y' : 'y' + (idx + 1);

                    for (let groupKey in groupedData) {
                        const group = groupedData[groupKey];
                        group.data.sort((a, b) => a[X_COL] - b[X_COL]);

                        let xValues, yValues;
                        if (AGGREGATOR === 'none') {
                            xValues = group.data.map(row => row[X_COL]);
                            yValues = group.data.map(row => row[Y_COL]);
                        } else {
                            // Group by x value and aggregate
                            const xGroups = {};
                            group.data.forEach(row => {
                                const xVal = row[X_COL];
                                if (!xGroups[xVal]) xGroups[xVal] = [];
                                xGroups[xVal].push(row[Y_COL]);
                            });

                            xValues = [];
                            yValues = [];
                            Object.keys(xGroups).sort((a, b) => a - b).forEach(xVal => {
                                const aggregated = aggregate(xGroups[xVal], AGGREGATOR);
                                if (aggregated && aggregated.length > 0) {
                                    xValues.push(parseFloat(xVal));
                                    yValues.push(aggregated[0]);
                                }
                            });
                        }

                        const traceName = COLOR_COL === LINETYPE_COL ?
                            group.color :
                            group.color + ' (' + group.linetype + ')';
                        const legendGroup = traceName;

                        traces.push({
                            x: xValues,
                            y: yValues,
                            type: 'scatter',
                            mode: 'lines+markers',
                            name: traceName,
                            legendgroup: legendGroup,
                            showlegend: idx === 0,
                            xaxis: xaxis,
                            yaxis: yaxis,
                            line: {
                                color: COLOR_MAP[group.color] || '#000000',
                                width: 1,
                                dash: LINETYPE_MAP[group.linetype] || 'solid'
                            },
                            marker: { size: 1 }
                        });
                    }

                    // Add axis configuration
                    layout[xaxis] = {
                        title: rowIdx === nRows - 1 ? (X_LABEL || X_COL) : '',
                        anchor: yaxis
                    };
                    layout[yaxis] = {
                        title: colIdx === 0 ? (Y_LABEL || Y_COL) : '',
                        anchor: xaxis
                    };

                    // Add annotations for facet labels
                    if (!layout.annotations) layout.annotations = [];

                    // Column header
                    if (rowIdx === 0) {
                        layout.annotations.push({
                            text: facetCol + ': ' + colVal,
                            showarrow: false,
                            xref: xaxis === 'x' ? 'x domain' : xaxis + ' domain',
                            yref: yaxis === 'y' ? 'y domain' : yaxis + ' domain',
                            x: 0.5,
                            y: 1.1,
                            xanchor: 'center',
                            yanchor: 'bottom',
                            font: {size: 10}
                        });
                    }

                    // Row label
                    if (colIdx === nCols - 1) {
                        layout.annotations.push({
                            text: facetRow + ': ' + rowVal,
                            showarrow: false,
                            xref: xaxis === 'x' ? 'x domain' : xaxis + ' domain',
                            yref: yaxis === 'y' ? 'y domain' : yaxis + ' domain',
                            x: 1.05,
                            y: 0.5,
                            xanchor: 'left',
                            yanchor: 'middle',
                            textangle: -90,
                            font: {size: 10}
                        });
                    }
                });
            });

            Plotly.newPlot('revenue_trend', traces, layout, {responsive: true});
        }
    };

    // Load and parse CSV data using centralized parser
    loadDataset('detailed_sales').then(function(data) {
        allData = data;
        window.updateChart_revenue_trend();
    }).catch(function(error) {
        console.error('Error loading data for chart revenue_trend:', error);
    });
})();
    window.downloadTableCSV_large_orders = function() {
        const csvContent = "ID,Customer,Order_Date,Product,Quantity,Unit_Price,Total\n1,Customer_1,2024-04-15,Product C,28,24.99,699.72\n2,Customer_2,2024-04-27,Product C,42,34.99,1469.58\n3,Customer_3,2024-02-03,Product A,15,14.99,224.85\n4,Customer_4,2024-03-10,Product B,30,19.99,599.7\n5,Customer_5,2024-05-23,Product A,37,19.99,739.63\n6,Customer_6,2024-03-23,Product E,11,9.99,109.89\n7,Customer_7,2024-01-03,Product E,48,24.99,1199.52\n8,Customer_8,2024-01-03,Product A,7,19.99,139.93\n9,Customer_9,2024-02-04,Product C,35,34.99,1224.65\n10,Customer_10,2024-06-10,Product C,13,34.99,454.87\n11,Customer_11,2024-06-06,Product B,29,19.99,579.71\n12,Customer_12,2024-05-25,Product B,44,24.99,1099.56\n13,Customer_13,2024-02-21,Product E,17,9.99,169.83\n14,Customer_14,2024-02-15,Product A,18,19.99,359.82\n15,Customer_15,2024-01-23,Product D,39,9.99,389.61\n16,Customer_16,2024-03-06,Product D,20,24.99,499.8\n17,Customer_17,2024-02-07,Product B,34,14.99,509.66\n18,Customer_18,2024-06-23,Product A,29,14.99,434.71\n19,Customer_19,2024-01-02,Product D,28,9.99,279.72\n20,Customer_20,2024-02-15,Product B,11,14.99,164.89\n21,Customer_21,2024-01-25,Product A,38,19.99,759.62\n22,Customer_22,2024-05-17,Product D,46,9.99,459.54\n23,Customer_23,2024-04-24,Product C,43,34.99,1504.57\n24,Customer_24,2024-02-29,Product E,37,34.99,1294.63\n25,Customer_25,2024-02-10,Product E,20,24.99,499.8\n26,Customer_26,2024-04-30,Product C,13,24.99,324.87\n27,Customer_27,2024-06-04,Product C,3,19.99,59.97\n28,Customer_28,2024-04-12,Product D,41,19.99,819.59\n29,Customer_29,2024-06-24,Product D,39,24.99,974.61\n30,Customer_30,2024-05-10,Product C,43,34.99,1504.57\n31,Customer_31,2024-02-05,Product D,38,19.99,759.62\n32,Customer_32,2024-06-15,Product E,3,14.99,44.97\n33,Customer_33,2024-03-05,Product A,33,19.99,659.67\n34,Customer_34,2024-05-09,Product C,35,24.99,874.65\n35,Customer_35,2024-03-03,Product A,31,9.99,309.69\n36,Customer_36,2024-02-20,Product D,25,19.99,499.75\n37,Customer_37,2024-05-31,Product D,34,19.99,679.66\n38,Customer_38,2024-06-09,Product D,10,24.99,249.9\n39,Customer_39,2024-02-02,Product C,17,9.99,169.83\n40,Customer_40,2024-01-15,Product B,22,34.99,769.78\n41,Customer_41,2024-04-01,Product C,15,34.99,524.85\n42,Customer_42,2024-06-25,Product C,49,9.99,489.51\n43,Customer_43,2024-04-22,Product E,29,9.99,289.71\n44,Customer_44,2024-01-22,Product E,13,14.99,194.87\n45,Customer_45,2024-05-25,Product B,32,14.99,479.68\n46,Customer_46,2024-03-04,Product E,47,14.99,704.53\n47,Customer_47,2024-02-14,Product D,21,14.99,314.79\n48,Customer_48,2024-02-13,Product E,3,19.99,59.97\n49,Customer_49,2024-06-11,Product B,4,34.99,139.96\n50,Customer_50,2024-01-17,Product D,9,9.99,89.91\n51,Customer_51,2024-04-10,Product C,39,19.99,779.61\n52,Customer_52,2024-05-26,Product E,15,34.99,524.85\n53,Customer_53,2024-02-12,Product D,4,9.99,39.96\n54,Customer_54,2024-01-17,Product C,11,14.99,164.89\n55,Customer_55,2024-05-19,Product A,45,24.99,1124.55\n56,Customer_56,2024-03-28,Product E,26,34.99,909.74\n57,Customer_57,2024-05-10,Product C,48,19.99,959.52\n58,Customer_58,2024-05-25,Product E,26,9.99,259.74\n59,Customer_59,2024-02-05,Product C,20,34.99,699.8\n60,Customer_60,2024-03-31,Product A,17,24.99,424.83\n61,Customer_61,2024-04-15,Product E,28,19.99,559.72\n62,Customer_62,2024-03-13,Product D,24,34.99,839.76\n63,Customer_63,2024-05-20,Product A,15,14.99,224.85\n64,Customer_64,2024-04-22,Product B,2,34.99,69.98\n65,Customer_65,2024-04-26,Product B,2,19.99,39.98\n66,Customer_66,2024-05-13,Product D,19,14.99,284.81\n67,Customer_67,2024-05-26,Product E,40,19.99,799.6\n68,Customer_68,2024-05-16,Product E,46,24.99,1149.54\n69,Customer_69,2024-02-17,Product D,40,34.99,1399.6\n70,Customer_70,2024-02-15,Product B,42,14.99,629.58\n71,Customer_71,2024-02-24,Product B,12,34.99,419.88\n72,Customer_72,2024-03-08,Product A,28,34.99,979.72\n73,Customer_73,2024-04-24,Product E,36,19.99,719.64\n74,Customer_74,2024-02-13,Product A,19,24.99,474.81\n75,Customer_75,2024-03-20,Product D,33,24.99,824.67\n76,Customer_76,2024-06-01,Product E,9,14.99,134.91\n77,Customer_77,2024-02-02,Product D,11,24.99,274.89\n78,Customer_78,2024-05-18,Product B,4,9.99,39.96\n79,Customer_79,2024-06-03,Product E,43,9.99,429.57\n80,Customer_80,2024-01-17,Product E,15,19.99,299.85\n81,Customer_81,2024-02-21,Product A,11,24.99,274.89\n82,Customer_82,2024-05-16,Product D,43,9.99,429.57\n83,Customer_83,2024-01-28,Product C,37,19.99,739.63\n84,Customer_84,2024-01-16,Product E,3,9.99,29.97\n85,Customer_85,2024-04-14,Product A,38,34.99,1329.62\n86,Customer_86,2024-04-30,Product E,42,34.99,1469.58\n87,Customer_87,2024-03-03,Product E,17,19.99,339.83\n88,Customer_88,2024-06-28,Product C,45,19.99,899.55\n89,Customer_89,2024-03-29,Product A,16,14.99,239.84\n90,Customer_90,2024-03-12,Product A,23,14.99,344.77\n91,Customer_91,2024-02-07,Product D,31,19.99,619.69\n92,Customer_92,2024-04-20,Product E,3,9.99,29.97\n93,Customer_93,2024-05-03,Product D,9,14.99,134.91\n94,Customer_94,2024-02-04,Product A,10,9.99,99.9\n95,Customer_95,2024-03-10,Product D,47,19.99,939.53\n96,Customer_96,2024-01-26,Product D,9,14.99,134.91\n97,Customer_97,2024-01-06,Product D,8,19.99,159.92\n98,Customer_98,2024-02-20,Product C,11,9.99,109.89\n99,Customer_99,2024-06-11,Product E,7,14.99,104.93\n100,Customer_100,2024-04-26,Product D,30,14.99,449.7\n";
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'large_orders.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    };
    window.downloadTableCSV_feature_comparison = function() {
        const csvContent = "Feature,PivotTable,Table,TextBlock\nInteractive,✓,✗,✗\nDownloadable,✓,✓,✗\nData Embedded,✓,✓,✗\nMultiple Formats,✓,✗,✗\nCustom Styling,✓,✓,✓\n";
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'feature_comparison.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    };


});
</script>

<!-- DATASETS -->

<script type="text/plain" id="detailed_sales" data-format="csv_embedded" data-src="">
Date,Revenue,Category,MonthNum
2024-01-01,5592,Online,1
2024-01-02,5827,Wholesale,1
2024-01-03,7142,Wholesale,1
2024-01-04,5546,Retail,1
2024-01-05,6755,Online,1
2024-01-06,6644,Online,1
2024-01-07,7178,Wholesale,1
2024-01-08,7005,Retail,1
2024-01-09,7954,Wholesale,1
2024-01-10,6994,Online,1
2024-01-11,7000,Wholesale,1
2024-01-12,5950,Online,1
2024-01-13,6199,Retail,1
2024-01-14,7657,Wholesale,1
2024-01-15,5298,Online,1
2024-01-16,7759,Online,1
2024-01-17,7682,Retail,1
2024-01-18,5883,Wholesale,1
2024-01-19,6394,Wholesale,1
2024-01-20,7724,Retail,1
2024-01-21,5055,Retail,1
2024-01-22,5578,Online,1
2024-01-23,7602,Online,1
2024-01-24,6686,Retail,1
2024-01-25,6150,Retail,1
2024-01-26,7999,Online,1
2024-01-27,7720,Online,1
2024-01-28,6232,Wholesale,1
2024-01-29,5519,Online,1
2024-01-30,5534,Online,1
2024-01-31,7823,Wholesale,1
2024-02-01,5877,Online,2
2024-02-02,7578,Wholesale,2
2024-02-03,6502,Wholesale,2
2024-02-04,7567,Online,2
2024-02-05,5650,Wholesale,2
2024-02-06,6170,Wholesale,2
2024-02-07,6684,Retail,2
2024-02-08,7427,Online,2
2024-02-09,6132,Wholesale,2
2024-02-10,7827,Wholesale,2
2024-02-11,5688,Wholesale,2
2024-02-12,7684,Retail,2
2024-02-13,6750,Online,2
2024-02-14,7825,Online,2
2024-02-15,7377,Retail,2
2024-02-16,6877,Retail,2
2024-02-17,5838,Online,2
2024-02-18,5334,Retail,2
2024-02-19,5454,Online,2
2024-02-20,5204,Wholesale,2
2024-02-21,5699,Online,2
2024-02-22,5748,Online,2
2024-02-23,7661,Retail,2
2024-02-24,7666,Retail,2
2024-02-25,5590,Retail,2
2024-02-26,6963,Retail,2
2024-02-27,6093,Wholesale,2
2024-02-28,5804,Wholesale,2
2024-02-29,6130,Wholesale,2
2024-03-01,6343,Retail,3
2024-03-02,7950,Online,3
2024-03-03,6841,Retail,3
2024-03-04,5368,Retail,3
2024-03-05,6256,Wholesale,3
2024-03-06,6320,Wholesale,3
2024-03-07,7106,Online,3
2024-03-08,5110,Wholesale,3
2024-03-09,7899,Wholesale,3
2024-03-10,5697,Online,3
2024-03-11,5748,Retail,3
2024-03-12,5469,Online,3
2024-03-13,5824,Wholesale,3
2024-03-14,5594,Online,3
2024-03-15,7736,Online,3
2024-03-16,5574,Online,3
2024-03-17,7669,Online,3
2024-03-18,6057,Wholesale,3
2024-03-19,6955,Wholesale,3
2024-03-20,7706,Wholesale,3
2024-03-21,5304,Online,3
2024-03-22,7124,Wholesale,3
2024-03-23,5082,Online,3
2024-03-24,7627,Online,3
2024-03-25,6598,Wholesale,3
2024-03-26,6236,Wholesale,3
2024-03-27,6537,Retail,3
2024-03-28,5383,Wholesale,3
2024-03-29,6950,Wholesale,3
2024-03-30,7382,Retail,3
2024-03-31,6409,Wholesale,3
2024-04-01,5141,Online,4
2024-04-02,6854,Wholesale,4
2024-04-03,5574,Wholesale,4
2024-04-04,7707,Wholesale,4
2024-04-05,5269,Retail,4
2024-04-06,7253,Online,4
2024-04-07,5332,Retail,4
2024-04-08,5352,Wholesale,4
2024-04-09,7058,Online,4
2024-04-10,5696,Online,4
2024-04-11,6194,Online,4
2024-04-12,7496,Online,4
2024-04-13,7400,Retail,4
2024-04-14,6295,Online,4
2024-04-15,5183,Retail,4
2024-04-16,5188,Retail,4
2024-04-17,7865,Wholesale,4
2024-04-18,6634,Retail,4
2024-04-19,7157,Online,4
2024-04-20,6185,Retail,4
2024-04-21,5970,Wholesale,4
2024-04-22,6100,Wholesale,4
2024-04-23,6170,Retail,4
2024-04-24,5197,Wholesale,4
2024-04-25,6726,Wholesale,4
2024-04-26,5679,Wholesale,4
2024-04-27,6310,Online,4
2024-04-28,7173,Wholesale,4
2024-04-29,6826,Wholesale,4
2024-04-30,5655,Wholesale,4
2024-05-01,6489,Online,5
2024-05-02,5776,Online,5
2024-05-03,5977,Wholesale,5
2024-05-04,7505,Wholesale,5
2024-05-05,6749,Retail,5
2024-05-06,7098,Wholesale,5
2024-05-07,7350,Online,5
2024-05-08,5354,Wholesale,5
2024-05-09,6523,Online,5
2024-05-10,5937,Retail,5
2024-05-11,6327,Retail,5
2024-05-12,5074,Retail,5
2024-05-13,6138,Wholesale,5
2024-05-14,5661,Wholesale,5
2024-05-15,7269,Online,5
2024-05-16,7054,Wholesale,5
2024-05-17,6431,Online,5
2024-05-18,7762,Wholesale,5
2024-05-19,5221,Online,5
2024-05-20,6016,Wholesale,5
2024-05-21,5910,Wholesale,5
2024-05-22,5702,Wholesale,5
2024-05-23,5000,Online,5
2024-05-24,7788,Wholesale,5
2024-05-25,5408,Wholesale,5
2024-05-26,6701,Wholesale,5
2024-05-27,5381,Online,5
2024-05-28,7763,Retail,5
2024-05-29,5930,Online,5
2024-05-30,6663,Retail,5
2024-05-31,7026,Online,5
2024-06-01,7416,Retail,6
2024-06-02,7818,Wholesale,6
2024-06-03,5674,Retail,6
2024-06-04,6345,Online,6
2024-06-05,7876,Retail,6
2024-06-06,5133,Wholesale,6
2024-06-07,7013,Retail,6
2024-06-08,5008,Wholesale,6
2024-06-09,6533,Retail,6
2024-06-10,5813,Retail,6
2024-06-11,7695,Online,6
2024-06-12,7088,Retail,6
2024-06-13,6494,Retail,6
2024-06-14,6502,Online,6
2024-06-15,6838,Online,6
2024-06-16,5754,Wholesale,6
2024-06-17,6910,Wholesale,6
2024-06-18,5477,Wholesale,6
2024-06-19,5095,Wholesale,6
2024-06-20,5471,Retail,6
2024-06-21,7154,Retail,6
2024-06-22,7583,Online,6
2024-06-23,6560,Retail,6
2024-06-24,5411,Wholesale,6
2024-06-25,6914,Online,6
2024-06-26,7174,Wholesale,6
2024-06-27,6509,Online,6
2024-06-28,5540,Online,6
2024-06-29,6899,Wholesale,6
2024-06-30,7776,Wholesale,6

</script>

<!-- ACTUAL CONTENT -->

<h1></h1>
<p></p>

    <div class="textblock-content">
        <h1>Table Examples</h1>
<p>This page demonstrates various Table features in JSPlots.</p>
<ul>
    <li><strong>Basic tables:</strong> Simple data display with CSV download</li>
    <li><strong>Calculated columns:</strong> Tables with computed metrics</li>
    <li><strong>Statistical summaries:</strong> Descriptive statistics</li>
    <li><strong>Special handling:</strong> Missing values and HTML escaping</li>
    <li><strong>Integration:</strong> Combining tables with charts and images</li>
</ul>
<p><em>Every table includes a 'Download as CSV' button for easy data export!</em></p>

    </div>
<br>
<hr>
<br>
    <div class="jsplots-table-container">
        <h2>basic_table</h2>
        <p>A simple table showing product inventory. Click the download button to export as CSV.</p>
        <div class="table-wrapper">
            <table>
  <thead>
    <tr><th>Product</th><th>Price</th><th>Stock</th><th>Category</th></tr>
  </thead>
  <tbody>
    <tr><td>Widget</td><td>9.99</td><td>100</td><td>Tools</td></tr>
    <tr><td>Gadget</td><td>14.99</td><td>50</td><td>Electronics</td></tr>
    <tr><td>Gizmo</td><td>24.99</td><td>25</td><td>Accessories</td></tr>
    <tr><td>Tool</td><td>19.99</td><td>75</td><td>Tools</td></tr>
    <tr><td>Device</td><td>34.99</td><td>15</td><td>Electronics</td></tr>
  </tbody>
</table>
        </div>
        <div class="table-actions">
            <button onclick="downloadTableCSV_basic_table()" class="download-csv-button">
                📥 Download as CSV
            </button>
        </div>
    </div>
<br><p style="text-align: right; font-size: 0.8em; color: #666; margin-top: -10px; margin-bottom: 10px;">Data: basic_table</p><br>
<hr>
<br>
    <div class="jsplots-table-container">
        <h2>financial_table</h2>
        <p>Financial performance with calculated metrics (Profit, Margin %, Average Price)</p>
        <div class="table-wrapper">
            <table>
  <thead>
    <tr><th>Month</th><th>Revenue</th><th>Expenses</th><th>Units_Sold</th><th>Profit</th><th>Margin_Percent</th><th>Avg_Price</th></tr>
  </thead>
  <tbody>
    <tr><td>January</td><td>45000</td><td>30000</td><td>450</td><td>15000</td><td>33.3</td><td>100.0</td></tr>
    <tr><td>February</td><td>52000</td><td>32000</td><td>520</td><td>20000</td><td>38.5</td><td>100.0</td></tr>
    <tr><td>March</td><td>48000</td><td>29000</td><td>480</td><td>19000</td><td>39.6</td><td>100.0</td></tr>
    <tr><td>April</td><td>61000</td><td>35000</td><td>610</td><td>26000</td><td>42.6</td><td>100.0</td></tr>
    <tr><td>May</td><td>58000</td><td>33000</td><td>580</td><td>25000</td><td>43.1</td><td>100.0</td></tr>
    <tr><td>June</td><td>67000</td><td>38000</td><td>670</td><td>29000</td><td>43.3</td><td>100.0</td></tr>
  </tbody>
</table>
        </div>
        <div class="table-actions">
            <button onclick="downloadTableCSV_financial_table()" class="download-csv-button">
                📥 Download as CSV
            </button>
        </div>
    </div>
<br><p style="text-align: right; font-size: 0.8em; color: #666; margin-top: -10px; margin-bottom: 10px;">Data: financial_table</p><br>
<hr>
<br>
    <div class="jsplots-table-container">
        <h2>statistics_table</h2>
        <p>Descriptive statistics comparing two groups</p>
        <div class="table-wrapper">
            <table>
  <thead>
    <tr><th>Statistic</th><th>Group_A</th><th>Group_B</th></tr>
  </thead>
  <tbody>
    <tr><td>Count</td><td>50.0</td><td>50.0</td></tr>
    <tr><td>Mean</td><td>74.37</td><td>81.56</td></tr>
    <tr><td>Median</td><td>73.88</td><td>83.62</td></tr>
    <tr><td>Std Dev</td><td>8.29</td><td>11.6</td></tr>
    <tr><td>Min</td><td>55.59</td><td>47.02</td></tr>
    <tr><td>Max</td><td>89.67</td><td>101.36</td></tr>
    <tr><td>Q1</td><td>68.62</td><td>75.38</td></tr>
    <tr><td>Q3</td><td>81.22</td><td>89.75</td></tr>
  </tbody>
</table>
        </div>
        <div class="table-actions">
            <button onclick="downloadTableCSV_statistics_table()" class="download-csv-button">
                📥 Download as CSV
            </button>
        </div>
    </div>
<br><p style="text-align: right; font-size: 0.8em; color: #666; margin-top: -10px; margin-bottom: 10px;">Data: statistics_table</p><br>
<hr>
<br>
    <div class="jsplots-table-container">
        <h2>special_chars_table</h2>
        <p>Table demonstrating HTML escaping and missing value handling</p>
        <div class="table-wrapper">
            <table>
  <thead>
    <tr><th>Name</th><th>Description</th><th>Price</th><th>Rating</th><th>Status</th></tr>
  </thead>
  <tbody>
    <tr><td>Alice &amp; Bob</td><td>Tools &amp; Hardware</td><td>100.5</td><td>4.5</td><td>Active</td></tr>
    <tr><td>Charlie&#39;s Shop</td><td>Books &lt;Rare&gt;</td><td></td><td>4.8</td><td>Active</td></tr>
    <tr><td></td><td>Electronics</td><td>250.0</td><td></td><td>Pending</td></tr>
    <tr><td>D&amp;D Store</td><td></td><td>75.25</td><td>3.9</td><td>Active</td></tr>
    <tr><td>E-Corp</td><td>Software &quot;Pro&quot;</td><td>500.0</td><td>4.2</td><td></td></tr>
  </tbody>
</table>
        </div>
        <div class="table-actions">
            <button onclick="downloadTableCSV_special_chars_table()" class="download-csv-button">
                📥 Download as CSV
            </button>
        </div>
    </div>
<br><p style="text-align: right; font-size: 0.8em; color: #666; margin-top: -10px; margin-bottom: 10px;">Data: special_chars_table</p><br>
<hr>
<br>
    <div class="jsplots-table-container">
        <h2>top_performers</h2>
        <p>Top 5 performers this quarter</p>
        <div class="table-wrapper">
            <table>
  <thead>
    <tr><th>Rank</th><th>Employee</th><th>Department</th><th>Score</th></tr>
  </thead>
  <tbody>
    <tr><td>1</td><td>Sarah Johnson</td><td>Sales</td><td>98</td></tr>
    <tr><td>2</td><td>Mike Chen</td><td>Engineering</td><td>96</td></tr>
    <tr><td>3</td><td>Emma Williams</td><td>Sales</td><td>95</td></tr>
    <tr><td>4</td><td>David Brown</td><td>Marketing</td><td>94</td></tr>
    <tr><td>5</td><td>Lisa Garcia</td><td>Engineering</td><td>93</td></tr>
  </tbody>
</table>
        </div>
        <div class="table-actions">
            <button onclick="downloadTableCSV_top_performers()" class="download-csv-button">
                📥 Download as CSV
            </button>
        </div>
    </div>
<br><p style="text-align: right; font-size: 0.8em; color: #666; margin-top: -10px; margin-bottom: 10px;">Data: top_performers</p><br>
<hr>
<br>
    <div class="jsplots-table-container">
        <h2>department_summary</h2>
        <p>Department-level summary statistics</p>
        <div class="table-wrapper">
            <table>
  <thead>
    <tr><th>Department</th><th>Employees</th><th>Avg_Score</th><th>Budget</th></tr>
  </thead>
  <tbody>
    <tr><td>Sales</td><td>12</td><td>87.3</td><td>500000</td></tr>
    <tr><td>Engineering</td><td>25</td><td>84.5</td><td>1200000</td></tr>
    <tr><td>Marketing</td><td>8</td><td>79.2</td><td>350000</td></tr>
    <tr><td>Operations</td><td>15</td><td>81.8</td><td>600000</td></tr>
  </tbody>
</table>
        </div>
        <div class="table-actions">
            <button onclick="downloadTableCSV_department_summary()" class="download-csv-button">
                📥 Download as CSV
            </button>
        </div>
    </div>
<br><p style="text-align: right; font-size: 0.8em; color: #666; margin-top: -10px; margin-bottom: 10px;">Data: department_summary</p><br>
<hr>
<br>
    <div class="jsplots-table-container">
        <h2>monthly_sales</h2>
        <p>Monthly sales summary (download for detailed analysis)</p>
        <div class="table-wrapper">
            <table>
  <thead>
    <tr><th>Month</th><th>Days</th><th>Total_Revenue</th><th>Avg_Daily_Revenue</th></tr>
  </thead>
  <tbody>
    <tr><td>Jan</td><td>31</td><td>206081.0</td><td>6647.77</td></tr>
    <tr><td>Feb</td><td>29</td><td>188799.0</td><td>6510.31</td></tr>
    <tr><td>Mar</td><td>31</td><td>199854.0</td><td>6446.9</td></tr>
    <tr><td>Apr</td><td>30</td><td>188639.0</td><td>6287.97</td></tr>
    <tr><td>May</td><td>31</td><td>196983.0</td><td>6354.29</td></tr>
    <tr><td>Jun</td><td>30</td><td>195473.0</td><td>6515.77</td></tr>
  </tbody>
</table>
        </div>
        <div class="table-actions">
            <button onclick="downloadTableCSV_monthly_sales()" class="download-csv-button">
                📥 Download as CSV
            </button>
        </div>
    </div>
<br><p style="text-align: right; font-size: 0.8em; color: #666; margin-top: -10px; margin-bottom: 10px;">Data: monthly_sales</p><br>
<hr>
<br>
<h2>Daily Revenue by Category</h2>
<p></p>

<!-- Controls -->
<div id="controls">
        <div style="margin: 10px;">
        <label for="aggregator_select_revenue_trend">Aggregator: </label>
        <select id="aggregator_select_revenue_trend" onchange="updateChart_revenue_trend()">
                <option value="none" selected>none</option>
                <option value="mean">mean</option>
                <option value="median">median</option>
                <option value="count">count</option>
                <option value="min">min</option>
                <option value="max">max</option>
        </select>
    </div>
    
</div>

<!-- Chart -->
<div id="revenue_trend"></div>
<br><p style="text-align: right; font-size: 0.8em; color: #666; margin-top: -10px; margin-bottom: 10px;">Data: detailed_sales</p><br>
<hr>
<br>
    <div class="picture-container">
        <h2>dashboard_image</h2>
        <p>Example image included in the dashboard</p>
        <img src="data:image/jpeg;base64,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" alt="dashboard_image" />
    </div>
<br><p style="text-align: right; font-size: 0.8em; color: #666; margin-top: -10px; margin-bottom: 10px;">images.jpeg</p><br>
<hr>
<br>
    <div class="jsplots-table-container">
        <h2>large_orders</h2>
        <p>Large table with 100 rows - demonstrates scrolling and CSV download capability</p>
        <div class="table-wrapper">
            <table>
  <thead>
    <tr><th>ID</th><th>Customer</th><th>Order_Date</th><th>Product</th><th>Quantity</th><th>Unit_Price</th><th>Total</th></tr>
  </thead>
  <tbody>
    <tr><td>1</td><td>Customer_1</td><td>2024-04-15</td><td>Product C</td><td>28</td><td>24.99</td><td>699.72</td></tr>
    <tr><td>2</td><td>Customer_2</td><td>2024-04-27</td><td>Product C</td><td>42</td><td>34.99</td><td>1469.58</td></tr>
    <tr><td>3</td><td>Customer_3</td><td>2024-02-03</td><td>Product A</td><td>15</td><td>14.99</td><td>224.85</td></tr>
    <tr><td>4</td><td>Customer_4</td><td>2024-03-10</td><td>Product B</td><td>30</td><td>19.99</td><td>599.7</td></tr>
    <tr><td>5</td><td>Customer_5</td><td>2024-05-23</td><td>Product A</td><td>37</td><td>19.99</td><td>739.63</td></tr>
    <tr><td>6</td><td>Customer_6</td><td>2024-03-23</td><td>Product E</td><td>11</td><td>9.99</td><td>109.89</td></tr>
    <tr><td>7</td><td>Customer_7</td><td>2024-01-03</td><td>Product E</td><td>48</td><td>24.99</td><td>1199.52</td></tr>
    <tr><td>8</td><td>Customer_8</td><td>2024-01-03</td><td>Product A</td><td>7</td><td>19.99</td><td>139.93</td></tr>
    <tr><td>9</td><td>Customer_9</td><td>2024-02-04</td><td>Product C</td><td>35</td><td>34.99</td><td>1224.65</td></tr>
    <tr><td>10</td><td>Customer_10</td><td>2024-06-10</td><td>Product C</td><td>13</td><td>34.99</td><td>454.87</td></tr>
    <tr><td>11</td><td>Customer_11</td><td>2024-06-06</td><td>Product B</td><td>29</td><td>19.99</td><td>579.71</td></tr>
    <tr><td>12</td><td>Customer_12</td><td>2024-05-25</td><td>Product B</td><td>44</td><td>24.99</td><td>1099.56</td></tr>
    <tr><td>13</td><td>Customer_13</td><td>2024-02-21</td><td>Product E</td><td>17</td><td>9.99</td><td>169.83</td></tr>
    <tr><td>14</td><td>Customer_14</td><td>2024-02-15</td><td>Product A</td><td>18</td><td>19.99</td><td>359.82</td></tr>
    <tr><td>15</td><td>Customer_15</td><td>2024-01-23</td><td>Product D</td><td>39</td><td>9.99</td><td>389.61</td></tr>
    <tr><td>16</td><td>Customer_16</td><td>2024-03-06</td><td>Product D</td><td>20</td><td>24.99</td><td>499.8</td></tr>
    <tr><td>17</td><td>Customer_17</td><td>2024-02-07</td><td>Product B</td><td>34</td><td>14.99</td><td>509.66</td></tr>
    <tr><td>18</td><td>Customer_18</td><td>2024-06-23</td><td>Product A</td><td>29</td><td>14.99</td><td>434.71</td></tr>
    <tr><td>19</td><td>Customer_19</td><td>2024-01-02</td><td>Product D</td><td>28</td><td>9.99</td><td>279.72</td></tr>
    <tr><td>20</td><td>Customer_20</td><td>2024-02-15</td><td>Product B</td><td>11</td><td>14.99</td><td>164.89</td></tr>
    <tr><td>21</td><td>Customer_21</td><td>2024-01-25</td><td>Product A</td><td>38</td><td>19.99</td><td>759.62</td></tr>
    <tr><td>22</td><td>Customer_22</td><td>2024-05-17</td><td>Product D</td><td>46</td><td>9.99</td><td>459.54</td></tr>
    <tr><td>23</td><td>Customer_23</td><td>2024-04-24</td><td>Product C</td><td>43</td><td>34.99</td><td>1504.57</td></tr>
    <tr><td>24</td><td>Customer_24</td><td>2024-02-29</td><td>Product E</td><td>37</td><td>34.99</td><td>1294.63</td></tr>
    <tr><td>25</td><td>Customer_25</td><td>2024-02-10</td><td>Product E</td><td>20</td><td>24.99</td><td>499.8</td></tr>
    <tr><td>26</td><td>Customer_26</td><td>2024-04-30</td><td>Product C</td><td>13</td><td>24.99</td><td>324.87</td></tr>
    <tr><td>27</td><td>Customer_27</td><td>2024-06-04</td><td>Product C</td><td>3</td><td>19.99</td><td>59.97</td></tr>
    <tr><td>28</td><td>Customer_28</td><td>2024-04-12</td><td>Product D</td><td>41</td><td>19.99</td><td>819.59</td></tr>
    <tr><td>29</td><td>Customer_29</td><td>2024-06-24</td><td>Product D</td><td>39</td><td>24.99</td><td>974.61</td></tr>
    <tr><td>30</td><td>Customer_30</td><td>2024-05-10</td><td>Product C</td><td>43</td><td>34.99</td><td>1504.57</td></tr>
    <tr><td>31</td><td>Customer_31</td><td>2024-02-05</td><td>Product D</td><td>38</td><td>19.99</td><td>759.62</td></tr>
    <tr><td>32</td><td>Customer_32</td><td>2024-06-15</td><td>Product E</td><td>3</td><td>14.99</td><td>44.97</td></tr>
    <tr><td>33</td><td>Customer_33</td><td>2024-03-05</td><td>Product A</td><td>33</td><td>19.99</td><td>659.67</td></tr>
    <tr><td>34</td><td>Customer_34</td><td>2024-05-09</td><td>Product C</td><td>35</td><td>24.99</td><td>874.65</td></tr>
    <tr><td>35</td><td>Customer_35</td><td>2024-03-03</td><td>Product A</td><td>31</td><td>9.99</td><td>309.69</td></tr>
    <tr><td>36</td><td>Customer_36</td><td>2024-02-20</td><td>Product D</td><td>25</td><td>19.99</td><td>499.75</td></tr>
    <tr><td>37</td><td>Customer_37</td><td>2024-05-31</td><td>Product D</td><td>34</td><td>19.99</td><td>679.66</td></tr>
    <tr><td>38</td><td>Customer_38</td><td>2024-06-09</td><td>Product D</td><td>10</td><td>24.99</td><td>249.9</td></tr>
    <tr><td>39</td><td>Customer_39</td><td>2024-02-02</td><td>Product C</td><td>17</td><td>9.99</td><td>169.83</td></tr>
    <tr><td>40</td><td>Customer_40</td><td>2024-01-15</td><td>Product B</td><td>22</td><td>34.99</td><td>769.78</td></tr>
    <tr><td>41</td><td>Customer_41</td><td>2024-04-01</td><td>Product C</td><td>15</td><td>34.99</td><td>524.85</td></tr>
    <tr><td>42</td><td>Customer_42</td><td>2024-06-25</td><td>Product C</td><td>49</td><td>9.99</td><td>489.51</td></tr>
    <tr><td>43</td><td>Customer_43</td><td>2024-04-22</td><td>Product E</td><td>29</td><td>9.99</td><td>289.71</td></tr>
    <tr><td>44</td><td>Customer_44</td><td>2024-01-22</td><td>Product E</td><td>13</td><td>14.99</td><td>194.87</td></tr>
    <tr><td>45</td><td>Customer_45</td><td>2024-05-25</td><td>Product B</td><td>32</td><td>14.99</td><td>479.68</td></tr>
    <tr><td>46</td><td>Customer_46</td><td>2024-03-04</td><td>Product E</td><td>47</td><td>14.99</td><td>704.53</td></tr>
    <tr><td>47</td><td>Customer_47</td><td>2024-02-14</td><td>Product D</td><td>21</td><td>14.99</td><td>314.79</td></tr>
    <tr><td>48</td><td>Customer_48</td><td>2024-02-13</td><td>Product E</td><td>3</td><td>19.99</td><td>59.97</td></tr>
    <tr><td>49</td><td>Customer_49</td><td>2024-06-11</td><td>Product B</td><td>4</td><td>34.99</td><td>139.96</td></tr>
    <tr><td>50</td><td>Customer_50</td><td>2024-01-17</td><td>Product D</td><td>9</td><td>9.99</td><td>89.91</td></tr>
    <tr><td>51</td><td>Customer_51</td><td>2024-04-10</td><td>Product C</td><td>39</td><td>19.99</td><td>779.61</td></tr>
    <tr><td>52</td><td>Customer_52</td><td>2024-05-26</td><td>Product E</td><td>15</td><td>34.99</td><td>524.85</td></tr>
    <tr><td>53</td><td>Customer_53</td><td>2024-02-12</td><td>Product D</td><td>4</td><td>9.99</td><td>39.96</td></tr>
    <tr><td>54</td><td>Customer_54</td><td>2024-01-17</td><td>Product C</td><td>11</td><td>14.99</td><td>164.89</td></tr>
    <tr><td>55</td><td>Customer_55</td><td>2024-05-19</td><td>Product A</td><td>45</td><td>24.99</td><td>1124.55</td></tr>
    <tr><td>56</td><td>Customer_56</td><td>2024-03-28</td><td>Product E</td><td>26</td><td>34.99</td><td>909.74</td></tr>
    <tr><td>57</td><td>Customer_57</td><td>2024-05-10</td><td>Product C</td><td>48</td><td>19.99</td><td>959.52</td></tr>
    <tr><td>58</td><td>Customer_58</td><td>2024-05-25</td><td>Product E</td><td>26</td><td>9.99</td><td>259.74</td></tr>
    <tr><td>59</td><td>Customer_59</td><td>2024-02-05</td><td>Product C</td><td>20</td><td>34.99</td><td>699.8</td></tr>
    <tr><td>60</td><td>Customer_60</td><td>2024-03-31</td><td>Product A</td><td>17</td><td>24.99</td><td>424.83</td></tr>
    <tr><td>61</td><td>Customer_61</td><td>2024-04-15</td><td>Product E</td><td>28</td><td>19.99</td><td>559.72</td></tr>
    <tr><td>62</td><td>Customer_62</td><td>2024-03-13</td><td>Product D</td><td>24</td><td>34.99</td><td>839.76</td></tr>
    <tr><td>63</td><td>Customer_63</td><td>2024-05-20</td><td>Product A</td><td>15</td><td>14.99</td><td>224.85</td></tr>
    <tr><td>64</td><td>Customer_64</td><td>2024-04-22</td><td>Product B</td><td>2</td><td>34.99</td><td>69.98</td></tr>
    <tr><td>65</td><td>Customer_65</td><td>2024-04-26</td><td>Product B</td><td>2</td><td>19.99</td><td>39.98</td></tr>
    <tr><td>66</td><td>Customer_66</td><td>2024-05-13</td><td>Product D</td><td>19</td><td>14.99</td><td>284.81</td></tr>
    <tr><td>67</td><td>Customer_67</td><td>2024-05-26</td><td>Product E</td><td>40</td><td>19.99</td><td>799.6</td></tr>
    <tr><td>68</td><td>Customer_68</td><td>2024-05-16</td><td>Product E</td><td>46</td><td>24.99</td><td>1149.54</td></tr>
    <tr><td>69</td><td>Customer_69</td><td>2024-02-17</td><td>Product D</td><td>40</td><td>34.99</td><td>1399.6</td></tr>
    <tr><td>70</td><td>Customer_70</td><td>2024-02-15</td><td>Product B</td><td>42</td><td>14.99</td><td>629.58</td></tr>
    <tr><td>71</td><td>Customer_71</td><td>2024-02-24</td><td>Product B</td><td>12</td><td>34.99</td><td>419.88</td></tr>
    <tr><td>72</td><td>Customer_72</td><td>2024-03-08</td><td>Product A</td><td>28</td><td>34.99</td><td>979.72</td></tr>
    <tr><td>73</td><td>Customer_73</td><td>2024-04-24</td><td>Product E</td><td>36</td><td>19.99</td><td>719.64</td></tr>
    <tr><td>74</td><td>Customer_74</td><td>2024-02-13</td><td>Product A</td><td>19</td><td>24.99</td><td>474.81</td></tr>
    <tr><td>75</td><td>Customer_75</td><td>2024-03-20</td><td>Product D</td><td>33</td><td>24.99</td><td>824.67</td></tr>
    <tr><td>76</td><td>Customer_76</td><td>2024-06-01</td><td>Product E</td><td>9</td><td>14.99</td><td>134.91</td></tr>
    <tr><td>77</td><td>Customer_77</td><td>2024-02-02</td><td>Product D</td><td>11</td><td>24.99</td><td>274.89</td></tr>
    <tr><td>78</td><td>Customer_78</td><td>2024-05-18</td><td>Product B</td><td>4</td><td>9.99</td><td>39.96</td></tr>
    <tr><td>79</td><td>Customer_79</td><td>2024-06-03</td><td>Product E</td><td>43</td><td>9.99</td><td>429.57</td></tr>
    <tr><td>80</td><td>Customer_80</td><td>2024-01-17</td><td>Product E</td><td>15</td><td>19.99</td><td>299.85</td></tr>
    <tr><td>81</td><td>Customer_81</td><td>2024-02-21</td><td>Product A</td><td>11</td><td>24.99</td><td>274.89</td></tr>
    <tr><td>82</td><td>Customer_82</td><td>2024-05-16</td><td>Product D</td><td>43</td><td>9.99</td><td>429.57</td></tr>
    <tr><td>83</td><td>Customer_83</td><td>2024-01-28</td><td>Product C</td><td>37</td><td>19.99</td><td>739.63</td></tr>
    <tr><td>84</td><td>Customer_84</td><td>2024-01-16</td><td>Product E</td><td>3</td><td>9.99</td><td>29.97</td></tr>
    <tr><td>85</td><td>Customer_85</td><td>2024-04-14</td><td>Product A</td><td>38</td><td>34.99</td><td>1329.62</td></tr>
    <tr><td>86</td><td>Customer_86</td><td>2024-04-30</td><td>Product E</td><td>42</td><td>34.99</td><td>1469.58</td></tr>
    <tr><td>87</td><td>Customer_87</td><td>2024-03-03</td><td>Product E</td><td>17</td><td>19.99</td><td>339.83</td></tr>
    <tr><td>88</td><td>Customer_88</td><td>2024-06-28</td><td>Product C</td><td>45</td><td>19.99</td><td>899.55</td></tr>
    <tr><td>89</td><td>Customer_89</td><td>2024-03-29</td><td>Product A</td><td>16</td><td>14.99</td><td>239.84</td></tr>
    <tr><td>90</td><td>Customer_90</td><td>2024-03-12</td><td>Product A</td><td>23</td><td>14.99</td><td>344.77</td></tr>
    <tr><td>91</td><td>Customer_91</td><td>2024-02-07</td><td>Product D</td><td>31</td><td>19.99</td><td>619.69</td></tr>
    <tr><td>92</td><td>Customer_92</td><td>2024-04-20</td><td>Product E</td><td>3</td><td>9.99</td><td>29.97</td></tr>
    <tr><td>93</td><td>Customer_93</td><td>2024-05-03</td><td>Product D</td><td>9</td><td>14.99</td><td>134.91</td></tr>
    <tr><td>94</td><td>Customer_94</td><td>2024-02-04</td><td>Product A</td><td>10</td><td>9.99</td><td>99.9</td></tr>
    <tr><td>95</td><td>Customer_95</td><td>2024-03-10</td><td>Product D</td><td>47</td><td>19.99</td><td>939.53</td></tr>
    <tr><td>96</td><td>Customer_96</td><td>2024-01-26</td><td>Product D</td><td>9</td><td>14.99</td><td>134.91</td></tr>
    <tr><td>97</td><td>Customer_97</td><td>2024-01-06</td><td>Product D</td><td>8</td><td>19.99</td><td>159.92</td></tr>
    <tr><td>98</td><td>Customer_98</td><td>2024-02-20</td><td>Product C</td><td>11</td><td>9.99</td><td>109.89</td></tr>
    <tr><td>99</td><td>Customer_99</td><td>2024-06-11</td><td>Product E</td><td>7</td><td>14.99</td><td>104.93</td></tr>
    <tr><td>100</td><td>Customer_100</td><td>2024-04-26</td><td>Product D</td><td>30</td><td>14.99</td><td>449.7</td></tr>
  </tbody>
</table>
        </div>
        <div class="table-actions">
            <button onclick="downloadTableCSV_large_orders()" class="download-csv-button">
                📥 Download as CSV
            </button>
        </div>
    </div>
<br><p style="text-align: right; font-size: 0.8em; color: #666; margin-top: -10px; margin-bottom: 10px;">Data: large_orders</p><br>
<hr>
<br>
    <div class="textblock-content">
        <h2>JSPlots Type Comparison</h2>
<p>This table compares features across different plot types in JSPlots.</p>
<p>Use the <strong>Table</strong> type when you need:</p>
<ul>
    <li>Simple, static data display</li>
    <li>CSV download capability</li>
    <li>Clean, professional formatting</li>
    <li>No interactive features required</li>
</ul>
<p>Use <strong>PivotTable</strong> when you need interactive data exploration with drag-and-drop capabilities.</p>

    </div>
<br>
<hr>
<br>
    <div class="jsplots-table-container">
        <h2>feature_comparison</h2>
        <p>Comparison of different JSPlots types</p>
        <div class="table-wrapper">
            <table>
  <thead>
    <tr><th>Feature</th><th>PivotTable</th><th>Table</th><th>TextBlock</th></tr>
  </thead>
  <tbody>
    <tr><td>Interactive</td><td>✓</td><td>✗</td><td>✗</td></tr>
    <tr><td>Downloadable</td><td>✓</td><td>✓</td><td>✗</td></tr>
    <tr><td>Data Embedded</td><td>✓</td><td>✓</td><td>✗</td></tr>
    <tr><td>Multiple Formats</td><td>✓</td><td>✗</td><td>✗</td></tr>
    <tr><td>Custom Styling</td><td>✓</td><td>✓</td><td>✓</td></tr>
  </tbody>
</table>
        </div>
        <div class="table-actions">
            <button onclick="downloadTableCSV_feature_comparison()" class="download-csv-button">
                📥 Download as CSV
            </button>
        </div>
    </div>
<br><p style="text-align: right; font-size: 0.8em; color: #666; margin-top: -10px; margin-bottom: 10px;">Data: feature_comparison</p><br>
<hr>
<br>
    <div class="textblock-content">
        <h2>Summary</h2>
<p>This page demonstrated all key Table features:</p>
<ul>
    <li>Basic product inventory table</li>
    <li>Financial data with calculated columns</li>
    <li>Statistical summaries</li>
    <li>HTML escaping and missing value handling</li>
    <li>Top performers and department summaries</li>
    <li>Integration with charts and images</li>
    <li>Large table with 100 rows</li>
    <li>Feature comparison</li>
</ul>
<p><strong>Tip:</strong> Every table includes a 'Download as CSV' button for easy data export!</p>

    </div>


<hr><p align="right"><small>This page was created using <a href="https://github.com/s-baumann/JSPlots.jl">JSPlots.jl</a>.</small></p>
</body>
</html>
